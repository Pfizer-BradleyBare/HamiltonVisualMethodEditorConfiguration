// {{{ 2 "IncludeGuard" "PragmaOnce"
#pragma once
// }} ""
#include "C:\\Program Files (x86)\\HAMILTON\\BAREB\\Script\\HamiltonVisualMethodEditor\\HamiltonVisualMethodEditorConfiguration\\Modules\\Vacuum\\Configuration\\Vacuum Config.hs_"
#include "HSLVacuuBrandPump.hsl"
#include "C:\\Program Files (x86)\\HAMILTON\\BAREB\\Script\\HamiltonVisualMethodEditor\\HamiltonVisualMethodEditorMethod\\Library\\Commands\\Commands.hs_"
#include "HSLExtensions\\Array2D.hsl"
#include "C:\\Program Files (x86)\\HAMILTON\\BAREB\\Script\\HamiltonVisualMethodEditor\\HamiltonVisualMethodEditorMethod\\Library\\Tools\\Tools.hs_"
#include "HSLExtensions\\Array3D.hsl"
#include "HSLStrLib.hsl"
#include "C:\\Program Files (x86)\\HAMILTON\\BAREB\\Script\\HamiltonVisualMethodEditor\\HamiltonVisualMethodEditorMethod\\Library\\Return\\Return.hs_"
#include "C:\\Program Files (x86)\\HAMILTON\\BAREB\\Script\\HamiltonVisualMethodEditor\\HamiltonVisualMethodEditorMethod\\Library\\Sequences\\Sequences.hs_"
/* {{ 2 "LibraryInsertLine" "" */ // }} ""
// {{ 2 "TemplateIncludeBlock" ""
#include "HSLMETEDLib.hs_"
#include "HSLMECCLib.hs_"
#include "HSLPTLLib.hsl"
// }} ""
// {{{ 2 "LibraryNamespace" "Begin"
namespace VACUUM {
// }} ""
variable VacuumHandles[];
variable VacuumReservations[];
variable IsInit;
/* {{ 2 "VariableInsertLine" "" */ // }} ""
// {{{ 2 "SubmethodForwardDeclaration" ""
function DeInit( device & ML_STAR, variable i_CommandString ) variable ;
function DoCommand( device & ML_STAR, variable i_CommandString ) variable ;
private function GetVacuumCollectionPlateSequenceString( device & ML_STAR, variable i_CommandString ) variable ;
private function GetVacuumManifoldParkSequenceString( device & ML_STAR, variable i_CommandString ) variable ;
private function GetVacuumManifoldSequenceString( device & ML_STAR, variable i_CommandString ) variable ;
private function GetVacuumPlateSequenceString( device & ML_STAR, variable i_CommandString ) variable ;
function Init( device & ML_STAR, variable i_CommandString ) variable ;
private function StartVacuum( device & ML_STAR, variable i_CommandString ) variable ;
private function StopVacuum( device & ML_STAR, variable i_CommandString ) variable ;
// }} ""
function _InitLibrary() {
// {{ 2 "AutoInitBlock" ""
PTL::SetWashingStateDefault("RinseTime1", 5);
PTL::SetWashingStateDefault("SoakTime1", 5);
PTL::SetWashingStateDefault("FlowRate1", 11);
PTL::SetWashingStateDefault("RinseTime2", 0);
PTL::SetWashingStateDefault("SoakTime2", 0);
PTL::SetWashingStateDefault("FlowRate2", 11);
PTL::SetWashingStateDefault("DrainingTime", 10);
PTL::SetWashingStateDefault("StartWashLiquid", 0);
PTL::SetLoadingStateDefault("RecoveryOptionContinue", hslTrue);
PTL::SetLoadingStateDefault("RecoveryOptionExclude", hslTrue);
PTL::SetLoadingStateDefault("RecoveryOptionDefault", 0);
PTL::SetLoadingStateDefault("KitLotCheckEnabled", hslFalse);
VACUUM_CONFIG::_InitLibrary();
COMMANDS::_InitLibrary();
TOOLS::_InitLibrary();
RETURN::_InitLibrary();
SEQUENCES::_InitLibrary();
// }} ""
}
function _ExitLibrary() {
// {{ 2 "AutoExitBlock" ""
VACUUM_CONFIG::_ExitLibrary();
COMMANDS::_ExitLibrary();
TOOLS::_ExitLibrary();
RETURN::_ExitLibrary();
SEQUENCES::_ExitLibrary();
// }} ""
}
// {{{ 5 "Init" "Begin"
function Init( device & ML_STAR, variable i_CommandString ) variable {
// }} ""
private variable Counter;
private variable NumComPorts;
private variable VacuumComPorts[];
private variable SupportedVacuumPlates[];
private variable NumVacuumPlates;
private variable Counter2;
private variable Dict[];
private variable SupportedVacuumPlatesArray[];
private variable Delimiter;
private variable Counter3;
private variable BreakFlag;
private variable VacuumPlateNamesString;
private variable VacuumPlateNameStringsArray[];
private variable ComPort;
private variable SSA[];
private variable SS2A[];
// {{ 5 "Init" "InitLocals"
// }} ""
// {{{ 99 1 0 "1fbff88e_7050_413f_a2b682dc37ce8995" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
VACUUM_CONFIG::Init();
// }} ""
// {{{ 100 1 0 "79aede9a_f871_431a_8518f0023b3002c9" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
VACUUM_CONFIG::GetVacuumComPorts(VacuumComPorts);
// }} ""
// {{{ 101 1 0 "4e6dea6c_1814_4188_9d959b31d9686dc5" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
VACUUM_CONFIG::GetSupportedVacuumPlates(SupportedVacuumPlates);
// }} ""
// {{ 102 1 0 "b2affbf5_d3a7_4b3d_b7702837342a6607" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 103 1 0 "dbced84c_9dec_4417_8eb428d43b185196" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("***** Checking Vacuum module sequences for validity *****"));
// }} ""
// {{ 104 1 0 "6958026a_48b2_4ac1_aec2c680101e2bc6" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
NumComPorts=VacuumComPorts.GetSize();
// }} ""
// {{ 105 1 0 "485c128e_052a_4f5b_b85e9b7f163e0883" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("***** Checking Vacuum module sequences for validity ***** Supported Vacuum Plates"));
// }} ""
// {{ 106 1 0 "ac27e6d8_05d7_4f1d_bfce7498dbba3075" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(Counter = 0; Counter < NumComPorts;)
{
Counter = Counter + 1;
// }} ""
// {{{ 107 1 0 "4bc0f23a_a5fc_402a_a6acf11331e60a3a" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
VACUUM_CONFIG::GetSupportedVacuumPlateSequences(SS2A);
// }} ""
// {{{ 108 1 0 "d3e23e1c_6cc7_4a1f_a1a6f38a9e2f7d4b" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
SSA = HSLExtensions::Array2D::GetColumn(SS2A, Counter);
// }} ""
// {{{ 109 1 0 "3e18688a_9b78_4ac8_b6b44edc4b3c23d7" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
SEQUENCES::CheckSequences(ML_STAR, SSA);
// }} ""
// {{ 110 1 0 "ac27e6d8_05d7_4f1d_bfce7498dbba3075" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 111 1 0 "60cfcb72_168e_470c_b40d954aa33f9172" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("***** Checking Vacuum module sequences for validity ***** Supported Collection Plates"));
// }} ""
// {{ 112 1 0 "044a542d_432c_42e2_a3564dee1d91c5a6" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(Counter = 0; Counter < NumComPorts;)
{
Counter = Counter + 1;
// }} ""
// {{{ 113 1 0 "780f47b1_e1d2_45f3_b200c10588a65a4a" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
VACUUM_CONFIG::GetSupportedVacuumCollectionPlateSequences(SS2A);
// }} ""
// {{{ 114 1 0 "a35b5a93_29e4_4c6f_a8863a0ae2882cb4" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
SSA = HSLExtensions::Array2D::GetColumn(SS2A, Counter);
// }} ""
// {{{ 115 1 0 "db2579ce_f0f8_46be_8c3676cba1863696" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
SEQUENCES::CheckSequences(ML_STAR, SSA);
// }} ""
// {{ 116 1 0 "044a542d_432c_42e2_a3564dee1d91c5a6" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 117 1 0 "846b588d_2ef9_4e10_b91e8c86af2a6025" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("***** Checking Vacuum module sequences for validity ***** Manifolds"));
// }} ""
// {{{ 118 1 0 "d924f745_ce29_4fef_b0b19baa02695e1f" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
VACUUM_CONFIG::GetVacuumManifoldSequenceStrings(SSA);
// }} ""
// {{{ 119 1 0 "2345cf0b_cc28_45f8_b6270b5f79d31128" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
SEQUENCES::CheckSequences(ML_STAR, SSA);
// }} ""
// {{ 120 1 0 "c8c7f208_fc5c_4ba1_97be0f6a48ffdcff" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("***** Checking Vacuum module sequences for validity ***** Parks"));
// }} ""
// {{{ 121 1 0 "efd40e32_571d_4c26_9eb1b1ce91f1a32b" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
VACUUM_CONFIG::GetVacuumParkSequenceStrings(SSA);
// }} ""
// {{{ 122 1 0 "bbbb0ce0_b251_4963_bb6bea941a73483e" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
SEQUENCES::CheckSequences(ML_STAR, SSA);
// }} ""
// {{ 123 1 0 "0c8da193_b2c6_45ad_a86d29e0c47f67c0" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("***** Checking Vacuum module sequences for validity ***** SUCCESS"));
// }} ""
// {{ 124 1 0 "b2affbf5_d3a7_4b3d_b7702837342a6607" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 125 1 0 "e46f55a4_1b6b_46fd_a6979bd61d9ede99" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
COMMANDS::ParseCommandParametersString(i_CommandString, Dict);
// }} ""
// {{{ 126 1 0 "99222866_5aad_488b_aff911fc13acc5cc" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
COMMANDS::GetDictionaryItem(Dict, Translate("VacuumPlateName"), VacuumPlateNamesString);
// }} ""
// {{{ 127 1 0 "56c46ec5_f8b4_4e5a_bc86eec03538dabf" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
Delimiter = COMMANDS::GetCommandStringDelimiter();
// }} ""
// {{{ 128 1 0 "86cd5ee6_2dd3_4e0f_96d30feb9a61df87" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
TOOLS::ParseDelimitedList(Delimiter, VacuumPlateNamesString, VacuumPlateNameStringsArray);
// }} ""
// {{ 129 1 0 "f3a40a62_18e5_487d_ac06b5f14117fce7" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
NumVacuumPlates=VacuumPlateNameStringsArray.GetSize();
// }} ""
// {{ 130 1 0 "f42d2683_f5a7_4cdd_ace5eb4fda1629cc" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
NumComPorts=VacuumComPorts.GetSize();
// }} ""
// {{ 131 1 0 "b4888011_8821_4c91_b3c9dd7f1c1a3f63" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (NumVacuumPlates > NumComPorts)
{
// }} ""
// {{ 132 1 0 "8c996fc3_54a8_4e86_a6c4d375aa7d6956" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("Not enough vacuums available"));
// }} ""
// {{ 133 1 0 "75c2c112_5552_48cd_98805dd4e4af665b" "{930D6C31-8EFB-11d4-A3BA-002035848439}"
abort;
// }} ""
// {{ 134 1 0 "b4888011_8821_4c91_b3c9dd7f1c1a3f63" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 135 1 0 "b23a9384_a542_4bcf_a207be36013dfaba" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
VacuumHandles.SetSize(NumComPorts);
// }} ""
// {{ 136 1 0 "f96546de_1753_4281_9e3710332d84c108" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
VacuumReservations.SetSize(NumComPorts);
// }} ""
// {{ 137 1 0 "5f4962cc_1ee1_4808_8fa0337b0a1fc170" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(Counter = 0; Counter < NumVacuumPlates;)
{
Counter = Counter + 1;
// }} ""
// {{ 138 1 0 "4b3fee55_274e_40fc_a0d37382acfcfe24" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(Counter2 = 0; Counter2 < NumComPorts;)
{
Counter2 = Counter2 + 1;
// }} ""
// {{ 139 1 0 "3ae0ca91_b1d0_413c_bf67d1f9c9b975a9" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
BreakFlag = 0;
// }} ""
// {{{ 140 1 0 "a4c90d82_d9bb_4354_bdc76acfc10f58df" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
SupportedVacuumPlatesArray = HSLExtensions::Array2D::GetColumn(SupportedVacuumPlates, Counter2);
// }} ""
// {{ 141 1 0 "a9cb3764_9142_4abe_b97fb8a5a48c82c0" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
NumVacuumPlates=SupportedVacuumPlatesArray.GetSize();
// }} ""
// {{ 142 1 0 "be8c4724_190b_4ebd_b29a1de409bb8f27" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(Counter3 = 0; Counter3 < NumVacuumPlates;)
{
Counter3 = Counter3 + 1;
// }} ""
// {{ 143 1 0 "de343fec_dd4d_4360_a51aa6089dc36c4e" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (VacuumPlateNameStringsArray.ElementAt( Counter -1) == SupportedVacuumPlatesArray.ElementAt( Counter3 -1))
{
// }} ""
// {{ 144 1 0 "fc105700_1c10_4407_a8c063e117d586da" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
VacuumReservations.SetAt(Counter2-1, VacuumPlateNameStringsArray.ElementAt( Counter -1));
// }} ""
// {{{ 145 1 0 "4e443ffc_d892_4cc3_aefc6f07442127f2" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
ComPort = StrIVal(VacuumComPorts.ElementAt( Counter -1));
// }} ""
// {{{ 146 1 0 "9d24d64a_843b_4dd7_bd22c1b89e80f103" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLStarBVSLib::BVSInitialize(VacuumHandles.ElementAt( Counter2 -1), ComPort);
// }} ""
// {{ 147 1 0 "1bb939cf_e495_479a_b6b39adc10c6623d" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
BreakFlag = 1;
// }} ""
// {{ 148 1 0 "bc6a7fd0_297d_492b_99b97756fa3e0851" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 149 1 0 "de343fec_dd4d_4360_a51aa6089dc36c4e" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 150 1 0 "be8c4724_190b_4ebd_b29a1de409bb8f27" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 151 1 0 "185ff24b_f2d1_4843_83d53ae3eb0c1768" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (BreakFlag == 1)
{
// }} ""
// {{ 152 1 0 "5c925efe_a018_44de_affb8e404d4521e3" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 153 1 0 "185ff24b_f2d1_4843_83d53ae3eb0c1768" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 154 1 0 "57a3ec10_c6ac_4cd3_84538103d7996fed" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (Counter2 == NumComPorts)
{
// }} ""
// {{ 155 1 0 "01031191_cc98_4a14_93adeaafd263f777" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("Could not find a vacuum the satisfies the requirements. Quitting."));
// }} ""
// {{ 156 1 0 "b5c2e4b5_5ec9_4e0b_958ff1816a3345d2" "{930D6C31-8EFB-11d4-A3BA-002035848439}"
abort;
// }} ""
// {{ 157 1 0 "57a3ec10_c6ac_4cd3_84538103d7996fed" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 158 1 0 "4b3fee55_274e_40fc_a0d37382acfcfe24" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 159 1 0 "5f4962cc_1ee1_4808_8fa0337b0a1fc170" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 160 1 0 "b2878613_1502_4b43_92eb9c6b9bd96498" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
IsInit = Translate("True");
// }} ""
// {{{ 161 1 0 "a2987917_6a63_409f_ae7de46987b30bed" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (0);
// }} ""
// {{{ 5 "Init" "End"
}
// }} ""
// {{{ 5 "GetVacuumManifoldParkSequenceString" "Begin"
private function GetVacuumManifoldParkSequenceString( device & ML_STAR, variable i_CommandString ) variable {
// }} ""
private variable VacuumPlateNameString;
private variable Dict[];
private variable NumVacuums;
private variable Counter;
private variable VacuumParkSequenceStrings[];
private variable Ret;
// {{ 5 "GetVacuumManifoldParkSequenceString" "InitLocals"
// }} ""
// {{{ 58 1 0 "4d9592f7_cef9_4d8c_b56cd23198f18a85" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
COMMANDS::ParseCommandParametersString(i_CommandString, Dict);
// }} ""
// {{{ 59 1 0 "ca7cc485_2a32_452e_b8807d057eba200c" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
COMMANDS::GetDictionaryItem(Dict, Translate("VacuumPlateName"), VacuumPlateNameString);
// }} ""
// {{{ 60 1 0 "b0933039_81f1_40c6_a53de82041aa6aa4" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
VACUUM_CONFIG::GetVacuumParkSequenceStrings(VacuumParkSequenceStrings);
// }} ""
// {{ 61 1 0 "941d1de1_c355_4b59_ac67905e0d47e1d6" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
NumVacuums=VacuumReservations.GetSize();
// }} ""
// {{ 62 1 0 "14b74269_49a0_46aa_a969dd60786108bf" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(Counter = 0; Counter < NumVacuums;)
{
Counter = Counter + 1;
// }} ""
// {{ 63 1 0 "8e1a72c5_3bed_44cc_94fe0ec7e7e6e4a9" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (VacuumPlateNameString == VacuumReservations.ElementAt( Counter -1))
{
// }} ""
// {{ 64 1 0 "3b17d2ca_3512_4257_8009760e7d89fb9f" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
Ret = VacuumParkSequenceStrings.ElementAt( Counter -1);
// }} ""
// {{{ 65 1 0 "b1be46e9_d386_400c_afeb897fee366746" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (Ret);
// }} ""
// {{ 66 1 0 "8e1a72c5_3bed_44cc_94fe0ec7e7e6e4a9" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 67 1 0 "14b74269_49a0_46aa_a969dd60786108bf" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{{ 5 "GetVacuumManifoldParkSequenceString" "End"
}
// }} ""
// {{{ 5 "GetVacuumManifoldSequenceString" "Begin"
private function GetVacuumManifoldSequenceString( device & ML_STAR, variable i_CommandString ) variable {
// }} ""
private variable NumVacuums;
private variable VacuumPlateNameString;
private variable Counter;
private variable Ret;
private variable Dict[];
private variable VacuumManifoldSequenceStrings[];
// {{ 5 "GetVacuumManifoldSequenceString" "InitLocals"
// }} ""
// {{{ 69 1 0 "c2c08525_f882_4e29_8ab704d7561f1476" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
COMMANDS::ParseCommandParametersString(i_CommandString, Dict);
// }} ""
// {{{ 70 1 0 "8df178e9_13cb_4e7e_834465510f2e8993" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
COMMANDS::GetDictionaryItem(Dict, Translate("VacuumPlateName"), VacuumPlateNameString);
// }} ""
// {{{ 71 1 0 "9e8f9e79_b1af_4e2b_a382ff891d0f628d" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
VACUUM_CONFIG::GetVacuumManifoldSequenceStrings(VacuumManifoldSequenceStrings);
// }} ""
// {{ 72 1 0 "d5c19964_19cc_4314_ad71c30ec968613c" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
NumVacuums=VacuumReservations.GetSize();
// }} ""
// {{ 73 1 0 "24ee439a_fa3e_4e3f_965e35cfe7c03324" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(Counter = 0; Counter < NumVacuums;)
{
Counter = Counter + 1;
// }} ""
// {{ 74 1 0 "c9e571ab_5921_4dbc_b41474899ae5641f" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (VacuumPlateNameString == VacuumReservations.ElementAt( Counter -1))
{
// }} ""
// {{ 75 1 0 "b74683f9_eae5_4fe2_9f5f92adf983bb51" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
Ret = VacuumManifoldSequenceStrings.ElementAt( Counter -1);
// }} ""
// {{{ 76 1 0 "d0093e25_356f_4bba_bbcced8694c4db5e" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (Ret);
// }} ""
// {{ 77 1 0 "c9e571ab_5921_4dbc_b41474899ae5641f" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 78 1 0 "24ee439a_fa3e_4e3f_965e35cfe7c03324" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{{ 5 "GetVacuumManifoldSequenceString" "End"
}
// }} ""
// {{{ 5 "GetVacuumCollectionPlateSequenceString" "Begin"
private function GetVacuumCollectionPlateSequenceString( device & ML_STAR, variable i_CommandString ) variable {
// }} ""
private variable NumVacuums;
private variable NumVacuumPlates;
private variable VacuumPlateNameString;
private variable Counter;
private variable Counter2;
private variable Ret;
private variable Dict[];
private variable VacuumCollectionPlatesArray[];
private variable VacuumPlatesArray[];
private variable VacuumCollectionPlates[];
private variable VacuumPlates[];
// {{ 5 "GetVacuumCollectionPlateSequenceString" "InitLocals"
// }} ""
// {{{ 39 1 0 "c54a31cf_298b_46f0_ad4c8d8e9e40a3fc" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
COMMANDS::ParseCommandParametersString(i_CommandString, Dict);
// }} ""
// {{{ 40 1 0 "b2899097_3afe_4c30_9bd844786d49a252" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
COMMANDS::GetDictionaryItem(Dict, Translate("VacuumPlateName"), VacuumPlateNameString);
// }} ""
// {{{ 41 1 0 "bad991ee_b9bb_4aec_be9a501946a59fa2" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
VACUUM_CONFIG::GetSupportedVacuumPlates(VacuumPlates);
// }} ""
// {{{ 42 1 0 "774cbc1a_4471_49bf_b1d892129665a565" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
VACUUM_CONFIG::GetSupportedVacuumCollectionPlateSequences(VacuumCollectionPlates);
// }} ""
// {{ 43 1 0 "682397e3_27fa_4555_a909b09a91d3f29b" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
NumVacuums=VacuumReservations.GetSize();
// }} ""
// {{ 44 1 0 "26b79588_5b76_4de1_9fb00472070d4333" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(Counter = 0; Counter < NumVacuums;)
{
Counter = Counter + 1;
// }} ""
// {{ 45 1 0 "31afcd19_21e3_4b48_9544f0322650c8f2" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (VacuumPlateNameString == VacuumReservations.ElementAt( Counter -1))
{
// }} ""
// {{{ 46 1 0 "d667747a_50e8_4d5f_993e242ccfc20d1c" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
VacuumPlatesArray = HSLExtensions::Array2D::GetColumn(VacuumPlates, Counter);
// }} ""
// {{ 47 1 0 "da1782fd_5683_4f56_a7af73dffa4ad231" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
NumVacuumPlates=VacuumPlatesArray.GetSize();
// }} ""
// {{ 48 1 0 "28ebdc3f_5eb6_4a72_ba798078cccabb18" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(Counter2 = 0; Counter2 < NumVacuumPlates;)
{
Counter2 = Counter2 + 1;
// }} ""
// {{ 49 1 0 "bc41220d_2649_4919_b01fb9df5172d9f5" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (VacuumPlateNameString == VacuumPlatesArray.ElementAt( Counter2 -1))
{
// }} ""
// {{{ 50 1 0 "af6a8483_0364_491b_817371d2fe5eae82" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
VacuumCollectionPlatesArray = HSLExtensions::Array2D::GetColumn(VacuumCollectionPlates, Counter);
// }} ""
// {{ 51 1 0 "29d8222d_176e_462f_ac67cadffab30f73" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
Ret = VacuumCollectionPlatesArray.ElementAt( Counter2 -1);
// }} ""
// {{{ 52 1 0 "da4879e0_5324_425a_ad1bb61e625b0ce5" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (Ret);
// }} ""
// {{ 53 1 0 "bc41220d_2649_4919_b01fb9df5172d9f5" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 54 1 0 "28ebdc3f_5eb6_4a72_ba798078cccabb18" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 55 1 0 "31afcd19_21e3_4b48_9544f0322650c8f2" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 56 1 0 "26b79588_5b76_4de1_9fb00472070d4333" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{{ 5 "GetVacuumCollectionPlateSequenceString" "End"
}
// }} ""
// {{{ 5 "GetVacuumPlateSequenceString" "Begin"
private function GetVacuumPlateSequenceString( device & ML_STAR, variable i_CommandString ) variable {
// }} ""
private variable NumVacuums;
private variable NumVacuumPlates;
private variable VacuumPlateNameString;
private variable Counter;
private variable Counter2;
private variable Ret;
private variable Dict[];
private variable VacuumPlatesArray[];
private variable VacuumPlates[];
private variable VacuumPlateSequences[];
private variable VacuumPlateSequencesArray[];
// {{ 5 "GetVacuumPlateSequenceString" "InitLocals"
// }} ""
// {{{ 80 1 0 "25e56013_9bb9_4e62_9c4a68c6fa713fbd" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
COMMANDS::ParseCommandParametersString(i_CommandString, Dict);
// }} ""
// {{{ 81 1 0 "9a75390e_2727_40a2_917ea02df0d73c46" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
COMMANDS::GetDictionaryItem(Dict, Translate("VacuumPlateName"), VacuumPlateNameString);
// }} ""
// {{{ 82 1 0 "ad576d3f_e06e_4a36_89f6b2c8ace4dccf" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
VACUUM_CONFIG::GetSupportedVacuumPlates(VacuumPlates);
// }} ""
// {{{ 83 1 0 "c935299a_225a_4fc0_96586cd2642142a9" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
VACUUM_CONFIG::GetSupportedVacuumPlateSequences(VacuumPlateSequences);
// }} ""
// {{ 84 1 0 "cb23f8f3_3e92_49ce_aa29f9ddff0782cf" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
NumVacuums=VacuumReservations.GetSize();
// }} ""
// {{ 85 1 0 "ff88dbce_8057_4efa_8fa465721379fafb" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(Counter = 0; Counter < NumVacuums;)
{
Counter = Counter + 1;
// }} ""
// {{ 86 1 0 "fac1b407_6917_4b99_b567d813fa104202" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (VacuumPlateNameString == VacuumReservations.ElementAt( Counter -1))
{
// }} ""
// {{{ 87 1 0 "14b250f7_bbc9_49c3_af7008dd186483ce" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
VacuumPlatesArray = HSLExtensions::Array2D::GetColumn(VacuumPlates, Counter);
// }} ""
// {{ 88 1 0 "c7ecf870_5525_45e1_9d18e456f0ac3172" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
NumVacuumPlates=VacuumPlatesArray.GetSize();
// }} ""
// {{ 89 1 0 "0e7e1ed1_2a02_4503_8e34987f0cf6f733" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(Counter2 = 0; Counter2 < NumVacuumPlates;)
{
Counter2 = Counter2 + 1;
// }} ""
// {{ 90 1 0 "82060781_6caf_4fcb_90b09cc2f2f511b2" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (VacuumPlateNameString == VacuumPlatesArray.ElementAt( Counter2 -1))
{
// }} ""
// {{{ 91 1 0 "e3ff5e49_97cd_449e_9fcab62b821ff620" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
VacuumPlateSequencesArray = HSLExtensions::Array2D::GetColumn(VacuumPlateSequences, Counter);
// }} ""
// {{ 92 1 0 "0739e7b7_c683_44a4_8a392d38118a7a5d" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
Ret = VacuumPlateSequencesArray.ElementAt( Counter2 -1);
// }} ""
// {{{ 93 1 0 "267d4248_4361_4259_99f1b599c42449d9" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (Ret);
// }} ""
// {{ 94 1 0 "82060781_6caf_4fcb_90b09cc2f2f511b2" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 95 1 0 "0e7e1ed1_2a02_4503_8e34987f0cf6f733" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 96 1 0 "fac1b407_6917_4b99_b567d813fa104202" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 97 1 0 "ff88dbce_8057_4efa_8fa465721379fafb" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{{ 5 "GetVacuumPlateSequenceString" "End"
}
// }} ""
// {{{ 5 "StartVacuum" "Begin"
private function StartVacuum( device & ML_STAR, variable i_CommandString ) variable {
// }} ""
private variable NumVacuums;
private variable VacuumPlateNameString;
private variable NumVacuumPlates;
private variable Counter;
private variable Counter2;
private variable Dict[];
private variable VacuumPlatesArray[];
private variable VacuumPlates[];
private variable VacuumPressureLevels[];
private variable PressureIndex;
private variable VacuumPressure;
private variable AmbientPressure;
// {{ 5 "StartVacuum" "InitLocals"
// }} ""
// {{{ 163 1 0 "b228d970_46e2_48d5_8037d68d885e4bec" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
COMMANDS::ParseCommandParametersString(i_CommandString, Dict);
// }} ""
// {{{ 164 1 0 "cdd74abd_23e3_4ab6_b6eb58d8b5e178ef" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
COMMANDS::GetDictionaryItem(Dict, Translate("VacuumPlateName"), VacuumPlateNameString);
// }} ""
// {{{ 165 1 0 "0ac2f640_6223_467a_8e279d40a9d186c9" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
COMMANDS::GetDictionaryItem(Dict, Translate("VacuumPressure"), VacuumPressure);
// }} ""
// {{{ 166 1 0 "de00b1e0_3cdd_4cd2_b85dda1d755b6a1f" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
VACUUM_CONFIG::GetSupportedVacuumPlates(VacuumPlates);
// }} ""
// {{{ 167 1 0 "35c83bdb_bbfb_4f42_8f9fd1d8977452bc" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
VACUUM_CONFIG::GetVacuumPressureLevels(VacuumPressureLevels);
// }} ""
// {{ 168 1 0 "b4d5938b_8098_452a_b81f7aef104b6db3" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
NumVacuums=VacuumReservations.GetSize();
// }} ""
// {{ 169 1 0 "bbab32d0_d53b_4bc7_b1f4a95614903fad" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(Counter = 0; Counter < NumVacuums;)
{
Counter = Counter + 1;
// }} ""
// {{ 170 1 0 "6dcc6fb5_d273_4217_a0125e52762b2ccb" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (VacuumPlateNameString == VacuumReservations.ElementAt( Counter -1))
{
// }} ""
// {{{ 171 1 0 "cb9d4ed8_8757_4125_9b870667cddcc8da" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
VacuumPlatesArray = HSLExtensions::Array2D::GetColumn(VacuumPlates, Counter);
// }} ""
// {{ 172 1 0 "f18a2bc9_a912_4ce2_bb294270c5ea349e" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
NumVacuumPlates=VacuumPlatesArray.GetSize();
// }} ""
// {{ 173 1 0 "cdcc6233_609a_484d_a2129039ee522436" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(Counter2 = 0; Counter2 < NumVacuumPlates;)
{
Counter2 = Counter2 + 1;
// }} ""
// {{ 174 1 0 "2f2f8952_39d1_4efc_89b433b68835507e" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (VacuumPlateNameString == VacuumPlatesArray.ElementAt( Counter2 -1))
{
// }} ""
// {{ 175 1 0 "e5acc836_6b12_42dc_9d3966c04a4bc800" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
PressureIndex = 0;
// }} ""
// {{ 176 1 0 "043962ac_1e80_4c03_85e2978f76e85ae5" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (VacuumPressure == "Low")
{
// }} ""
// {{ 177 1 0 "c6a1a036_a7bd_4ba2_aa71de6e5b105bb5" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
PressureIndex = 1;
// }} ""
// {{ 178 1 0 "043962ac_1e80_4c03_85e2978f76e85ae5" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 179 1 0 "c2d5876a_f51f_436c_9d4380c0a685a0b5" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (VacuumPressure == "Normal")
{
// }} ""
// {{ 180 1 0 "da81acbc_aa20_4dbe_89617991419c6821" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
PressureIndex = 2;
// }} ""
// {{ 181 1 0 "c2d5876a_f51f_436c_9d4380c0a685a0b5" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 182 1 0 "2adfab92_c576_431e_a55604f7cc530a33" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (VacuumPressure == "High")
{
// }} ""
// {{ 183 1 0 "2081d975_60d8_435b_8bfef96399a42f29" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
PressureIndex = 3;
// }} ""
// {{ 184 1 0 "2adfab92_c576_431e_a55604f7cc530a33" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 185 1 0 "6066774d_df84_48da_a17c749983968dbb" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (PressureIndex != 0)
{
// }} ""
// {{{ 186 1 0 "577fc955_8353_4e79_9f05b3bec0cfba3c" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
VacuumPressure = HSLExtensions::Array3D::GetValue(VacuumPressureLevels, Counter, Counter2, PressureIndex);
// }} ""
// {{ 187 1 0 "6066774d_df84_48da_a17c749983968dbb" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 188 1 0 "a64ec086_6299_49b7_9c1bde9be8815a50" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
VacuumPressure = StrIVal(VacuumPressure);
// }} ""
// {{{ 189 1 0 "4ce34490_71d5_4f1c_a3d4631b08fc21bc" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
AmbientPressure = HSLVacuuBrandPump::ReqActualPressure(VacuumHandles.ElementAt( Counter -1));
// }} ""
// {{ 190 1 0 "3f37047e_8c29_4582_942ef14f7f690230" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
VacuumPressure = AmbientPressure - VacuumPressure;
// }} ""
// {{{ 191 1 0 "83c6f42a_eb2c_4b17_afd29a7b24c77e34" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLVacuuBrandPump::StartPressureControl(VacuumHandles.ElementAt( Counter -1), VacuumPressure, 99999, 1, 1);
// }} ""
// {{{ 192 1 0 "5c127f3c_d3fd_406b_a9301a745749b98f" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (0);
// }} ""
// {{ 193 1 0 "2f2f8952_39d1_4efc_89b433b68835507e" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 194 1 0 "cdcc6233_609a_484d_a2129039ee522436" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 195 1 0 "6dcc6fb5_d273_4217_a0125e52762b2ccb" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 196 1 0 "bbab32d0_d53b_4bc7_b1f4a95614903fad" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{{ 5 "StartVacuum" "End"
}
// }} ""
// {{{ 5 "StopVacuum" "Begin"
private function StopVacuum( device & ML_STAR, variable i_CommandString ) variable {
// }} ""
private variable NumVacuums;
private variable VacuumPlateNameString;
private variable Counter;
private timer VacuumStopTimer;
private variable Dict[];
// {{ 5 "StopVacuum" "InitLocals"
// }} ""
// {{{ 198 1 0 "e5a3fe4b_a25c_4296_92962c907df2ae23" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
COMMANDS::ParseCommandParametersString(i_CommandString, Dict);
// }} ""
// {{{ 199 1 0 "a7e4ee14_3cf1_4299_8a39fac31defb712" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
COMMANDS::GetDictionaryItem(Dict, Translate("VacuumPlateName"), VacuumPlateNameString);
// }} ""
// {{ 200 1 0 "21107ef6_6146_4ae6_b5659de6ac43216d" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
NumVacuums=VacuumReservations.GetSize();
// }} ""
// {{ 201 1 0 "1f3d0675_77fb_4e7b_ac3a0f46726ec901" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(Counter = 0; Counter < NumVacuums;)
{
Counter = Counter + 1;
// }} ""
// {{ 202 1 0 "0d1d599c_60ac_429c_b1b546b8f3375f6d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (VacuumPlateNameString == VacuumReservations.ElementAt( Counter -1))
{
// }} ""
// {{{ 203 1 0 "bca79133_6ecb_4191_8b8a616fabfe6f89" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLVacuuBrandPump::StopPumpImmediatly(VacuumHandles.ElementAt( Counter -1));
// }} ""
// {{{ 204 1 0 "9f82160f_eb1f_4a07_af27121e9584c47f" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLVacuuBrandPump::OpenAirAdmittanceValve(VacuumHandles.ElementAt( Counter -1));
// }} ""
// {{ 205 1 0 "f9fe171f_d9be_4ea0_90d27f234061c547" "{B31F353E-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == VacuumStopTimer.SetTimer(10) )
{
    MECC::RaiseRuntimeErrorEx(-1355939584, MECC::IDS::stepNameTimerStart, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 206 1 0 "29d53346_7e6b_4836_a109434f846b8c9d" "{B31F353F-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == VacuumStopTimer.WaitTimer(hslFalse, hslFalse) )
{
    MECC::RaiseRuntimeErrorEx(-1339162368, MECC::IDS::stepNameTimerWait, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{{ 207 1 0 "19b45822_1f23_4402_b2541cceac56414f" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (0);
// }} ""
// {{ 208 1 0 "0d1d599c_60ac_429c_b1b546b8f3375f6d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 209 1 0 "1f3d0675_77fb_4e7b_ac3a0f46726ec901" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{{ 5 "StopVacuum" "End"
}
// }} ""
// {{{ 5 "DoCommand" "Begin"
function DoCommand( device & ML_STAR, variable i_CommandString ) variable {
// }} ""
private variable Command;
private variable ReturnString;
// {{ 5 "DoCommand" "InitLocals"
// }} ""
// {{{ 9 1 0 "f83ab046_880a_417a_b9b5b349bcf9ac2a" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
Command = COMMANDS::GetCommandStringCommand(i_CommandString);
// }} ""
// {{ 10 1 0 "fe90b6ea_70f0_4b12_bc3ab58bfbb192aa" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (IsInit != "True")
{
// }} ""
// {{{ 11 1 0 "235a353b_9ff5_4d16_b6dfa63c5555982e" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
ReturnString = RETURN::CreateReturnString(-2, Translate("Module not initialized"), Translate(""), Translate(""));
// }} ""
// {{{ 12 1 0 "91cabfcf_b813_4283_bea259881a7fc1d9" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ReturnString);
// }} ""
// {{ 13 1 0 "fe90b6ea_70f0_4b12_bc3ab58bfbb192aa" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 14 1 0 "c0e5192b_9789_4632_8c574b094c3c47c4" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (Command == "GetVacuumCollectionPlateSequenceString")
{
// }} ""
// {{{ 15 1 0 "a32e1087_6991_44dc_a97da43079c68460" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
ReturnString = GetVacuumCollectionPlateSequenceString(ML_STAR, i_CommandString);
// }} ""
// {{{ 16 1 0 "95cd799f_d939_4a84_b93431942879e864" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ReturnString);
// }} ""
// {{ 17 1 0 "c0e5192b_9789_4632_8c574b094c3c47c4" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 18 1 0 "9b4c20de_1a74_45aa_87b3a2ea0da45d47" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (Command == "GetVacuumManifoldParkSequenceString")
{
// }} ""
// {{{ 19 1 0 "f274b623_5db3_4aa2_95c1ca300fc4b365" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
ReturnString = GetVacuumManifoldParkSequenceString(ML_STAR, i_CommandString);
// }} ""
// {{{ 20 1 0 "a63daed5_14bf_4b38_8581cb2e34c0b244" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ReturnString);
// }} ""
// {{ 21 1 0 "9b4c20de_1a74_45aa_87b3a2ea0da45d47" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 22 1 0 "3d339427_02af_4b6d_9eca0c649a87e6b1" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (Command == "GetVacuumManifoldSequenceString")
{
// }} ""
// {{{ 23 1 0 "29b9b8c1_1d2a_4511_81defe7eb9363104" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
ReturnString = GetVacuumManifoldSequenceString(ML_STAR, i_CommandString);
// }} ""
// {{{ 24 1 0 "d32289c7_0d04_4e95_9f539d0e56cf8dfd" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ReturnString);
// }} ""
// {{ 25 1 0 "3d339427_02af_4b6d_9eca0c649a87e6b1" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 26 1 0 "fdfec1c6_2724_4fac_9bea11fdb7f58c09" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (Command == "GetVacuumPlateSequenceString")
{
// }} ""
// {{{ 27 1 0 "7e5de127_711d_4ab7_838f7a86d7559f31" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
ReturnString = GetVacuumPlateSequenceString(ML_STAR, i_CommandString);
// }} ""
// {{{ 28 1 0 "2af9844b_60a7_47a7_93b6871fa2064ea3" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ReturnString);
// }} ""
// {{ 29 1 0 "fdfec1c6_2724_4fac_9bea11fdb7f58c09" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 30 1 0 "4b556ee0_5e73_4dda_b7f2106c91c1ca87" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (Command == "StartVacuum")
{
// }} ""
// {{{ 31 1 0 "5fe26c75_9185_439b_b66594df09bbd646" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
ReturnString = StartVacuum(ML_STAR, i_CommandString);
// }} ""
// {{{ 32 1 0 "c49efafe_1f60_4717_84de55d1985c7d38" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ReturnString);
// }} ""
// {{ 33 1 0 "4b556ee0_5e73_4dda_b7f2106c91c1ca87" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 34 1 0 "82f58bd8_4e0c_4763_a9d753c453af671f" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (Command == "StopVacuum")
{
// }} ""
// {{{ 35 1 0 "072dcdb8_6407_4f94_8c13a2be7f4672e4" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
ReturnString = StopVacuum(ML_STAR, i_CommandString);
// }} ""
// {{{ 36 1 0 "d031e65e_41b6_44b5_a8ea13aa6e9fa200" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (ReturnString);
// }} ""
// {{ 37 1 0 "82f58bd8_4e0c_4763_a9d753c453af671f" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 5 "DoCommand" "End"
}
// }} ""
// {{{ 5 "DeInit" "Begin"
function DeInit( device & ML_STAR, variable i_CommandString ) variable {
// }} ""
private variable NumVacuums;
private variable Counter;
// {{ 5 "DeInit" "InitLocals"
// }} ""
// {{ 1 1 0 "91753aef_3851_4c07_a0e24a6224a55298" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (IsInit == "True")
{
// }} ""
// {{ 2 1 0 "711940a8_9cff_45a5_b9e264e618e9b16b" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
NumVacuums=VacuumHandles.GetSize();
// }} ""
// {{ 3 1 0 "39bad7c0_7065_409c_ae173dae75e65968" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(Counter = 0; Counter < NumVacuums;)
{
Counter = Counter + 1;
// }} ""
// {{{ 4 1 0 "7fdcc039_eaaa_492c_95f621762cb0f3ea" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLStarBVSLib::BVSTerminate(VacuumHandles.ElementAt( Counter -1));
// }} ""
// {{ 5 1 0 "39bad7c0_7065_409c_ae173dae75e65968" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 6 1 0 "91753aef_3851_4c07_a0e24a6224a55298" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 7 1 0 "1221836f_486d_4a89_8f1e69344e9f85f3" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (Translate("True"));
// }} ""
// {{{ 5 "DeInit" "End"
}
// }} ""
/* {{ 2 "SubmethodInsertLine" "" */ // }} ""
// {{{ 2 "LibraryNamespace" "End"
} // library namespace
// }} ""
// $$author=BAREB$$valid=0$$time=2022-01-06 13:39$$checksum=2c75e466$$length=084$$